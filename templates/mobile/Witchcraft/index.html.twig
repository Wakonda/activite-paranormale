{% extends "mobile/mobile_layout.html.twig" %}

{% block title %}{{ "mobile.main.Witchcraft"|trans([], "validators") }}{% endblock %}
{% block page_title%}
	{{ "mobile.main.Witchcraft"|trans([], "validators") }}
	{% if app.request.attributes.get('theme') != "" %}
		{{ (" - "~app.request.attributes.get('theme')) }}
	{% endif %}
{% endblock %}

{% block additional_javascript %}
	<script>
		$(function ()
		{
			$('select.selected_theme_news').change(function()
			{
				var DATA = $("#choose_theme_news").serialize();
				$.ajax(
				{
					type: "POST",
					url: "{{ path('ap_witchcraftmobile_selectthemeforindexwitchcraft') }}",
					data: DATA,
					cache: false,
					success: function(data)
					{
						document.location.href = data;
					}
				});
				return false;
			});
			
			$("div.media").click(function() {
				document.location.href = $(this).find("a").attr("href");
			});
		});
	</script>
{% endblock %}

{% block body_content %}
	<form name="choixTheme" id="choose_theme_news" action="{{ path('ap_witchcraftmobile_index', { 'page' : 1}) }}" method="post" class="form-inline">
		<div class="form-group mr-2">
			<label for="theme_news">{{ "news.index.ChoisissezUnTheme"|trans([], "validators") }} : </label>
			<select id="theme_news" name="theme_news" class="form-control selected_theme_news">
				<option value="">{{ "news.index.Tout"|trans([], "validators") }}</option>
				{% for key, theme in themeArray %}
					<optgroup label="{{ key }}">
					{% for id, th in theme %}
						<option value="{{id }}">{{ th }}</option>
					{% endfor %}
					</optgroup>
				{% endfor %}
			</select>
		</div>
		<button id="selectTheme" type="submit" class="btn btn-primary"><i class="far fa-eye" aria-hidden="true"></i> {{ "mobile.witchcraft.AllRituals"|trans([], 'validators') }}</button> 
	</form>

	{% set adLocation = (pagination.items|length / 2)|round %}
	{% set i = 0 %}

	{% for entity in pagination.items %}
	{% set i = i + 1 %}
	{% if i == adLocation %}
		<div class="media-container m-0 mt-3">
			<h3>{{ "generality.page.Advertisement"|trans([], "validators") }}</h3>
			<br>
			<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
			<!-- AP_Mobile_2 -->
			<ins class="adsbygoogle"
				 style="display:block"
				 data-ad-client="ca-pub-1951906303386196"
				 data-ad-slot="8068030897"
				 data-ad-format="auto"
				 data-full-width-responsive="true"></ins>
			<script>
				 (adsbygoogle = window.adsbygoogle || []).push({});
			</script>
		</div>
	{% endif %}
	<div class="row media-container m-0 mt-3">
		<div class="col-sm-4 mt-7 mb-7">
		{{ entity.photo|imgsizeMobile(entity.getAssetImagePath())|raw }}
		</div>
		<div class="col-sm-8 mt-7">
			<h4 class="media-heading"><a href="{{ path('ap_witchcraftmobile_read', { 'id' : entity.id }) }}" alt="">{{ entity.title }}</a></h4>
			<hr>
			<i>{{ entity.surTheme.menuGrimoire.title }} - {{ entity.surTheme.title }} - <i class="fas fa-calendar-alt"></i> {{ entity.writingDate|date_mobile(app.request.locale) }}</i>
		</div>
	</div>
	{% else %}
	<br>
	<div class="alert alert-danger"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> {{ "mobile.witchcraft.NoRitual"|trans([], "validators") }}</div>
	{% endfor %}
	<div class="mt-3 justify-content-center">
		{{ knp_pagination_render(pagination) }}
	</div>
{% endblock %}